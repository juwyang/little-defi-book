
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <title>Primitives · HonKit</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="HonKit 6.0.3">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/@honkit/honkit-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/@honkit/honkit-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="applications.html" />
    
    
    <link rel="prev" href="./" />
    

    </head>
    <body>
        
<div class="book honkit-cloak">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.2" data-path="primitives.html">
            
                <a href="primitives.html">
            
                    
                    Primitives
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="applications.html">
            
                <a href="applications.html">
            
                    
                    Applications
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://github.com/honkit/honkit" target="blank" class="gitbook-link">
            Published with HonKit
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Primitives</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h3 id="去中心化金融defi，区块链技术blockchain，分布式账本distributed-ledger，比特币bitcoin-btc和以太坊ethereum-eth">去中心化金融(DeFi)，区块链技术(Blockchain)，分布式账本(Distributed Ledger)，比特币(Bitcoin, BTC)和以太坊(Ethereum, ETH)</h3>
<ul>
<li>DeFi: 是一系列去中心化金融服务，基于以太坊上的智能合约, 每一个服务或者产品都对应一种智能合约的实现。应用场景包括： 借贷(Loanable Funds Markets)、去中心化交易所(DEX)、稳定币(Stablecoins)、衍生品(Derivatives)等。</li>
<li>Blockchain: 本质是一种数据库技术，一个分布式的账本(Distributed Ledger)。分布式是指有多个节点构成一个网络，所有节点都保存一份相同的账本副本。每个区块包含一系列交易数据，时间戳，以及前一个区块的加密哈希(溯源前一个区块的钥匙)。当一个新的区块生成时，它会被添加到链的末尾，每个节点的副本都会对应更新，形成一个难以篡改的交易记录。比特币和以太坊的区块链都是公链(每个人能看到数据)，还有其他区块链平台以及一些私链、联盟链。</li>
<li>比特币: 第一个成功的、基于区块链技术的去中心化加密货币。主要Satoshi Nakamoto(中本聪)于2009年1月3日发行了比特币创世区块。</li>
<li>以太坊: 一个区块链平台，类比于一个社区，特点是引入了智能合约(Smart Contracts)的概念，允许开发者在其上构建去中心化应用(DApps), 以实现更复杂的功能。在2013年由Vitalik Buterin提出。在这个平台上，可以实现如 ERC-20 代币，非同质化代币 (NFTs)，去中心化自治组织 (DAOs)等。</li>
<li>分布式账本: 是最广泛的范畴，除了区块链实现，还有其他实现方式,如DAGs (Directed Acyclic Graphs，有向无环图，例如IOTA的Tangle或Hedera Hashgraph)</li>
</ul>
<pre><code class="lang-text">总结: 
(底层技术)区块链技术是一种基础技术。
(第一层: 区块链平台)比特币和以太坊都是基于区块链技术的具体实现和平台，它们各自有自己的协议来定义其运作方式。
(第二层: 应用层)去中心化金融 (DeFi) 则是建立在像以太坊这样的区块链平台之上的一系列金融应用，这些应用也遵循特定的协议。
去中心化的两重含义:
1. 基础设施架构: 网络是去中心化的，每一个节点和其他节点相连，而不是一个中心化的节点。
2. 智能合约的应用：不需要一个中心化的中介来执行合约条款，所有的交易都是在区块链上自动执行的。
</code></pre>
<h3 id="智能合约为什么智能，什么叫协议protocol？">智能合约为什么智能，什么叫协议(protocol)？</h3>
<ul>
<li>智能合约是指部署在区块链上的自执行代码，当预设条件满足时自动执行合约条款。智能主要是指"自动化执行"无需人为干预。类比自动售货机，只需要一方选择商品，投入钱币，就可以自动完成交易。</li>
<li>协议贯穿了区块链技术的各个层次。本质就是社区共同认可的规范，比如语言就是人类的协议，人们遵循相同的语法和语义来进行交流。在区块链技术底层，有网络协议、共识协议(Consensus Protocol)，(i)各个平台有自己的协议，如比特币协议、以太坊协议，这些协议规定了共识算法(例如，比特币选择了PoW，以太坊最初也是PoW，后来转向PoS),区块奖励规则(新区块产生时奖励多少新的原生代币给矿工/验证者，以及这个奖励是否会随时间变化（如比特币的减半机制）),新代币的产生机制(原生代币（如BTC, ETH）主要就是通过区块奖励产生的。协议规定了其初始供应量（如果有的话）和后续的发行速率) 交易费模型(用户支付的交易费如何分配。), 难度调整算法((PoW中的Nonce难度)：协议中会包含一个算法，根据网络的总算力（或区块产生速率）自动调整挖矿难度，以维持一个相对稳定的出块时间。)以及区块结构和大小限制等。这些初始设置都编码在协议的第一个版本的客户端软件中。后续的重大更改通常需要通过硬分叉，并得到网络参与者的广泛接受和升级。(ii)在应用层还有一系列DeFi协议，如借贷协议(规定了借贷利率、清算阈值等)、ERC-20协议(规定了代币合约必须实现的函数如<code>transfer()</code>, <code>balanceOf()</code>以使得不同的代币能够以统一的方式与钱包、交易所和其他智能合约交互)、uniswap流动性池自动做市商协议等。</li>
</ul>
<pre><code class="lang-text">总结:
协议是规则的集合，智能合约是规则的实现方式。
</code></pre>
<h3 id="一笔交易的一生">一笔交易的一生</h3>
<ul>
<li>账户分为两种: 用户拥有的钱包叫做EOA(Externally Owned Account)，包括一对密钥。从私钥可以通过密码学算法派生出公钥，再从公钥派生出该账户的公开地址（例如，以太坊地址以<code>0x</code>开头）。地址是公开的，用于接收资金和识别账户。还有一类账户叫做合约账户(Contract Account)，它们是智能合约的实例，比如Uniswap的交易对合约、一个ERC-20代币合约等都是合约账户, 通过智能合约代码控制，也拥有一个地址。只有EOA可以发起交易，合约账户不能主动发起交易，只能响应EOA的调用。EOA可发起的交易包括：转账(向另一个EOA地址发送一定数量的原生代币)，调用合约账户的函数(比如在DEX上交换代币、铸造NFT、参与借贷等)。</li>
<li>交易的lifecycle: (i)用户通过私钥签署一笔交易，通过MetaMask等钱包软件或是自己运行的节点软件(如Geth)，将交易请求发送到所连接的区块链网络上的节点，节点初步检查交易格式、签名、账户余额等，(ii)如果通过交易会被放到这个节点的内存池(Mempool)中，同时通过Gossip协议传播到网络的其他节点。(iii)各个节点的运营者(矿工或验证者)争夺到添加下一个区块的权利以后，会从内存池中选择一批(愿意支付更多交易费用的)交易进行打包，形成一个新区块，这个节点会在本地的以太坊虚拟机 (Ethereum Virtual Machine, EVM) 或类似环境中执行完成交易所需要的代码(如调用智能合约)，执行过程中，合约的状态可能会发生改变（例如，变量值更新、发生事件、向其他地址转账等）。执行交易的矿工/验证者会将执行结果（新的状态根哈希、交易收据等）包含在提议的区块中，并将该区块广播给网络中的其他节点。 (iv) 其他全节点收到新区块后，会独立地重新执行区块中的所有交易（包括智能合约调用），以验证其有效性和结果。</li>
<li>在执行交易的过程中会有一些运算，比如调用智能合约的函数，或者转账等，这些运算会在以太坊虚拟机(EVM)中执行。EVM中的每一个底层操作码（opcode），比如加法 (ADD)、存储数据到区块链 (SSTORE)、从存储中读取数据 (SLOAD) 等，都有一个预先定义好的Gas成本。这些成本会由交易的发起者支付给矿工/验证者。</li>
<li>如果发生了交易失败（状态回滚，就像从未发生过一样），但已经消耗的Gas（直到超出上限的那一点）仍然会被支付给矿工/验证者。</li>
</ul>
<pre><code class="lang-text">总结：
钱包发起交易请求 - 节点接收请求并广播 - 矿工\验证者选择并打包 - 其他节点验算区块，交易入链
成本由交易的发起者(sender)支付给矿工\验证者
</code></pre>
<h3 id="节点和网络、矿工和验证者">节点和网络、矿工和验证者</h3>
<ul>
<li>节点是运行着特定区块链的客户端软件(例如，Bitcoin Core，以太坊的 Geth 或 Nethermind)的单个计算机或服务器，他们与其他节点通过互联网直接通信，共享和同步区块链数据，构成了区块链网络。他们的功能是：储存区块链的副本，验证交易和区块，向其他节点传播信息等。</li>
<li>矿工(Miner)或验证者(Validator)所在的节点是一些特殊的生产区块的节点。矿工和验证者分别对应PoW(Proof-of-Work)和PoS(Proof-of-Stake)两种共识机制。比特币采取PoW共识，以太坊采取PoS共识。挖矿是指矿工尝试找到一个称为 "nonce" 的值，当这个nonce与区块中的其他数据一起进行哈希运算时，产生的哈希结果必须小于一个特定的目标值（这个目标值会根据网络算力动态调整，以保证大约每隔固定时间产生一个区块，例如比特币约10分钟，以太坊早期约15秒）。第一个成功挖出区块的矿工会获得一定数量的新发行的原生代币（区块奖励）以及该区块内所有交易的交易费用。验证者是通过质押一定数量的区块链原生代币来获得参与创建和验证新区块资格的节点或个人/组织，系统会根据某种算法（通常与验证者质押的代币数量、质押时长等因素相关）选择一个验证者来提议下一个新区块。其他验证者会对提议的区块进行投票。在PoW系统中，任何拥有足够计算能力（通常是专门的ASIC矿机或GPU）并运行相应挖矿软件的个人或组织都可以成为矿工。在PoS系统中，任何拥有足够数量的原生代币进行质押，并运行相应验证者客户端软件的个人或组织都可以成为验证者。在以太坊PoS中，截至2024年初，活跃的验证者数量超过90万。</li>
</ul>
<h3 id="代币">代币</h3>
<ul>
<li>代币分为两种类型: 原生代币(Native Token)和通过智能合约创建的代币。原生代币如BTC、ETH是区块链协议的一部分，如BTC规定通过挖矿产生，有固定上限 (2100万)，产量周期性减半。ETH: 最初通过 PoW 挖矿，现通过 PoS 质押奖励产生，发行策略可通过社区共识调整。直接存储在对应区块链的账户（地址）中。用户通过控制私钥来控制这些地址上的原生代币。</li>
<li>另一类应用层代币。是在区块链平台上(如以太坊)通过智能合约创建的代币, 其发行总量、增发机制、销毁机制等都由代币合约的创建者设定。ERC-20是可互换代币(Fungible Tokens)的标准协议，ERC-721是非同质化代币(NFT)的标准协议，一个标准协议类似一个插座接口，其规定了代币合约必须实现的函数。这方便了不同的代币与代币、钱包、智能合约和交易所之间的交互。如当用户添加一个新的 ERC-20 Token 时，钱包就知道可以用 <code>balanceOf()</code> 去查询这个 Token 的余额，用 <code>transfer()</code> 去发起转账。Fungible Tokens表明这类代币的每一个单位都是完全相同且可以互换的，包括稳定币(如USDC、DAI等)，治理代币(如Uniswap的UNI, 持有者可以用它们对协议的未来发展进行投票，每个同类治理代币的投票权是相同的。) Non-Fungible Tokens 这类代币的每一个都是独一无二、不可分割且不可替代的。每个 NFT 都有其独特的属性和标识符。包括数字艺术品、游戏内物品、虚拟地产等。NFT 的所有权和交易记录都存储在区块链上。例子：一个稳定币USDC的智能合约，当其发行方（如Circle）收到等值的美元储备后，他们可以通过其控制的特权地址调用USDC合约的铸造函数，在链上生成相应数量的USDC代币并发送到指定地址。一个NFT项目方，在用户支付了铸造费用后，其智能合约会调用铸造函数，为用户创建一个新的、唯一的NFT（分配一个新的代币ID并记录用户为所有者）。</li>
</ul>
<h3 id="在cex也可以交易数字货币">在CEX也可以交易数字货币</h3>
<ul>
<li>对于大多数普通用户来说，中心化交易所是购买、出售和交易数字货币最主要的场所。一些著名的中心化交易所例子包括：<ul>
<li>币安 (Binance)：目前全球交易量最大的加密货币交易所之一。</li>
<li>Coinbase: 一家在美国上市的知名交易所，特别受美国用户欢迎。</li>
<li>Kraken: 另一家老牌且信誉良好的交易所，提供多种加密货币交易。</li>
<li>火币 (Huobi Global)：在亚洲市场有重要影响力的交易所。
除了存款和提款外，用户与交易所之间的交易是通过off-chain的内部交易在CEX内部账本上进行。</li>
</ul>
</li>
<li>存款: 当用户想要在CEX上交易时，他们首先需要将自己的数字货币（例如比特币、以太坊或某种ERC-20代币）从他们自己的个人钱包（这是一个在相应区块链上的地址）发送到CEX为该用户生成的特定存款地址。这个存款地址是CEX控制的一个区块链地址。这笔从用户个人钱包到CEX存款地址的转账是一笔真实的链上交易 (on-chain transaction)，它会被记录在相应的分布式账本（例如比特币区块链或以太坊区块链）上。CEX的系统会监控其存款地址。当检测到一笔成功的链上存款后，CEX会在其内部的、中心化的数据库（或内部账本）中为该用户的账户记入相应的金额。提款则相反。</li>
<li>在CEX上交易: 一旦用户的资金在CEX的内部账本中得到确认，用户就可以在该平台上进行交易了（例如，用BTC买入ETH）。这些在CEX平台内部发生的交易，绝大多数情况下并不会立即在区块链上产生新的交易记录。 相反，CEX只是更新其内部中心化数据库中不同用户的余额。例如，用户A卖出1 BTC给用户B，CEX的数据库会将用户A的BTC余额减1，用户B的BTC余额加1。这种链下处理方式使得交易速度非常快（几乎是即时的），并且交易费用通常较低（或者是CEX收取的固定平台手续费），因为它们不直接消耗区块链网络的Gas费或矿工费。</li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="./" class="navigation navigation-prev " aria-label="Previous page: Introduction">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="applications.html" class="navigation navigation-next " aria-label="Next page: Applications">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Primitives","level":"1.2","depth":1,"next":{"title":"Applications","level":"1.3","depth":1,"path":"applications.md","ref":"applications.md","articles":[]},"previous":{"title":"Introduction","level":"1.1","depth":1,"path":"README.md","ref":"README.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56},"embedFonts":false},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"primitives.md","mtime":"2025-05-19T15:34:08.350Z","type":"markdown"},"gitbook":{"version":"6.0.3","time":"2025-05-19T18:44:00.548Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <noscript>
        <style>
            .honkit-cloak {
                display: block !important;
            }
        </style>
    </noscript>
    <script>
        // Restore sidebar state as critical path for prevent layout shift
        function __init__getSidebarState(defaultValue){
            var baseKey = "";
            var key = baseKey + ":sidebar";
            try {
                var value = localStorage[key];
                if (value === undefined) {
                    return defaultValue;
                }
                var parsed = JSON.parse(value);
                return parsed == null ? defaultValue : parsed;
            } catch (e) {
                return defaultValue;
            }
        }
        function __init__restoreLastSidebarState() {
            var isMobile = window.matchMedia("(max-width: 600px)").matches;
            if (isMobile) {
                // Init last state if not mobile
                return;
            }
            var sidebarState = __init__getSidebarState(true);
            var book = document.querySelector(".book");
            // Show sidebar if it enabled
            if (sidebarState && book) {
                book.classList.add("without-animation", "with-summary");
            }
        }

        try {
            __init__restoreLastSidebarState();
        } finally {
            var book = document.querySelector(".book");
            book.classList.remove("honkit-cloak");
        }
    </script>
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/@honkit/honkit-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

